function results = compileExamples(mode, confs, sels, save, varargin)

data = { ...
         {001, 1, 'resultados\molmot\Y2010M04D23h20m25s41\1_0.01_1', 'classic',                                                  [4877 5735 7750 9131]}, ...
         {002, 1, 'resultados\molmot\Y2010M04D23h20m33s01\1_0.01_1', 'brownian 0.5',                                             [2459 5961 6002 3716 1495 6370 6406]}, ...
         {003, 1, 'resultados\molmot\Y2010M04D25h10m01s12\1_0.01_1', 'classic',                                                  [3676 3452 714]}, ...
         {004, 1, 'resultados\molmot\Y2010M04D27h16m08s59\1_0.01_1', 'classic',                                                  [3640]}, ...
         {005, 1, 'resultados\molmot\Y2010M04D27h16m07s37\1_0.01_1', 'brownian 0.5',                                             [135 3048 4860]}, ...
         {006, 1, 'resultados\molmot\Y2010M04D28h20m18s01\1_0.01_1', 'classic',                                                  [5581]}, ...
         {007, 1, 'resultados\molmot\Y2010M04D29h18m47s39\1_0.01_1', 'classic',                                                  [2450 3741 2892 2927 2271 2012 5322]}, ...
         {008, 1, 'resultados\molmot\Y2010M04D29h18m47s51\1_0.01_1', 'brownian 0.5',                                             [3097 4362 3403]}, ...
         {009, 1, 'resultados\molmot\Y2010M04D30h17m50s47\1_0.01_1', 'brownian 0.5',                                             [5442 1660 4792 4847]}, ...
         {010, 1, 'resultados\molmot\Y2010M04D30h19m18s08\1_0.01_1', 'classic',                                                  [16 580]}, ...
         {011, 1, 'resultados\molmot\Y2010M05D02h14m08s53\1_0.01_1', 'classic',                                                  [4532 3942 2617]}, ...
         {012, 1, 'resultados\molmot\Y2010M05D01h20m40s43\1_0.01_1', 'brownian 0.5',                                             [9531]}, ...
         {013, 1, 'resultados\molmot\Y2010M05D04h11m51s07\1_0.01_1', 'brownian 0.5',                                             [5965]}, ...
         {014, 1, 'resultados\molmot\Y2010M05D06h12m38s15\1_0.01_1', 'classical',                                                [16626 11955 5395 5290 8105 9171 16118 16797 20156 15045 17652 19528 16678 17889 19027 18393]}, ...
         {015, 1, 'resultados\molmot\Y2010M05D06h12m38s42\1_0.01_1', 'classical',                                                [4209 7365 3598 5180 7136 10245 12229 402 6421 6511 7995 12108 18174 18357]}, ...
         {016, 1, 'resultados\molmot\Y2010M05D09h01m26s13\1_0.01_1', 'classical triangle',                                       [21052 23528 23203 221 5296 6343 14143 11701 15522 1010 6793 10907 15996 8151 6041 7898 11272 16901 21452 39639 35187 26802 29631 37150 33778]}, ...
         {017, 2, 'resultados\molmot\Y2010M05D25h16m26s04\1_0.01_1', '3D random defective',                                      8451}, ...
         {018, 2, 'resultados\molmot\Y2010M05D26h13m26s34\1_0.01_1', '3D random defective',                                      4351}, ...
         {019, 2, 'resultados\molmot\Y2010M05D26h16m37s57\1_0.01_1', '3D random defective',                                      [30265 3684]}, ...
         {020, 2, 'resultados\molmot\Y2010M05D26h16m48s12\1_0.01_1', '3D random defective',                                      [30655 30019 28674]}, ...
         {021, 2, 'resultados\molmot\Y2010M05D27h13m01s42\1_0.01_1', '3D random defective',                                      32217}, ...
         {022, 2, 'resultados\molmot\Y2010M05D27h13m01s51\1_0.01_1', '3D random defective',                                      [27969 32443 31537 19668 25226 29891 11692]}, ...
         {023, 2, 'resultados\molmot\Y2010M05D31h19m32s43\1_0.01_1', '3D random simplest',                                       29861}, ...
         {024, 2, 'resultados\molmot\Y2010M05D31h19m56s22\1_0.01_1', '3D random neighsPassive',                                  [20756 30413 31099 29553 23740]}, ...
         {025, 2, 'resultados\molmot\Y2010M06D01h16m07s06\1_0.01_1', '3D random neighsPassive',                                  36725}, ...
         {026, 2, 'resultados\molmot\Y2010M06D01h16m07s13\1_0.01_1', '3D random simplest',                                       [33544 16091]}, ...
         {027, 2, 'resultados\molmot\Y2010M06D02h19m00s49\1_0.01_1', '3D random neighsPassive',                                  35815}, ...
         {028, 2, 'resultados\molmot\Y2010M06D02h19m03s42\1_0.01_1', '3D random simplest',                                       30832}, ...
         {029, 2, 'resultados\molmot\Y2010M06D06h08m20s14\1_0.01_1', '3D random simplest 3spg:0-0.25',                           [39156 18507]}, ...
         {030, 2, 'resultados\molmot\Y2010M06D22h03m20s46\1_0.01_1', '3D random simplest 8spg:0-0.5',                            39909}, ...
         {031, 2, 'resultados\molmot\Y2010M06D24h18m29s44\1_0.01_1', '3D random hoh simplest attachmode=1',                      39726}, ...
         {032, 2, 'resultados\molmot\Y2010M06D25h08m14s05\1_0.01_1', '3D random hoh simplest attachmode=0',                      [38535 24967]}, ...
         {033, 2, 'resultados\molmot\Y2010M06D28h20m39s05\1_0.01_1', '3D random hoh simplest attachmode=0 spchg',                29422}, ...
         {034, 2, 'resultados\molmot\Y2010M06D29h15m56s08\1_0.01_1', 'FO 3D random hoh simplest attachmode=0 spchg',             13413}, ...
         {035, 2, 'resultados\molmot\Y2010M06D30h11m34s16\1_0.01_1', '3D random hoh dist2Near simplest attachmode=0 spchg',      39451}, ...
         {036, 2, 'resultados\molmot\Y2010M07D02h13m49s44\1_0.01_1', '3D random hoh dist2Near simplest attachmode=0 spchg',      18966}, ...
         {037, 2, 'resultados\molmot\Y2010M07D02h13m56s22\1_0.01_1', 'FO 3D random hoh dist2Near simplest attachmode=0 spchg',   18913}, ...
         {038, 2, 'resultados\molmot\Y2010M06D07h07m39s36\1_0.01_1', '3D random simplest 3spg:2.5-inf',                          24555}, ...
         {039, 2, 'resultados\molmot\Y2010M06D07h12m19s21\1_0.01_1', '3D random neighsPassive 3spg:2.5-inf',                     34785}, ...
         {040, 2, 'resultados\molmot\Y2010M06D08h08m40s23\1_0.01_1', '3D random simplest 1spg:2.5-inf',                          26273}, ...
         {041, 2, 'resultados\molmot\Y2010M06D08h15m22s39\1_0.01_1', '3D random neighsPassive 1spg:2.5-inf',                     39280}, ...
         {042, 2, 'resultados\molmot\Y2010M07D12h11m42s54\1_0.01_1', '3D random hoh dist2Near simplest attachmode=0 spchg fitness absabs swingAngle 0.174',                     [9780, 2139, 4002, 9780]}, ...
         {043, 2, 'resultados\molmot\Y2010M07D12h11m43s09\1_0.01_1', 'FO 3D random hoh dist2Near simplest attachmode=0 spchg fitness absabs swingAngle 0.174',                  [39280 40087]}, ...
         {044, 2, 'resultados\molmot\Y2010M07D14h16m10s02\1_0.01_1', '3D random hoh dist2Near simplest attachmode=0 spchg fitness absabs swingAngle 0.174',                     [39472 35753]}, ...
         {045, 2, 'resultados\molmot\Y2010M07D16h16m24s02\1_0.01_1', '3D random hoh dist2Near simplest attachmode=0 spchg fitness absabs swingAngle 0.174 zerosnan=false',      [27780 33483]}, ...
         {046, 2, 'resultados\Y2010M07D30h21m22s37\1_0.01_1', '3D random dist2Near simplest attachmode=1 spchg fitness mode3 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      9657}, ...
         {047, 2, 'resultados\Y2010M07D31h20m00s01\1_0.01_1', '3D random dist2Near simplest attachmode=1 spchg fitness mode3 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      8756}, ...
         {048, 2, 'resultados\Y2010M08D01h04m17s06\1_0.01_1', '3D random dist2Near simplest attachmode=1 spchg fitness mode3 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      8055}, ...
         {049, 2, 'resultados\Y2010M08D01h12m04s52\1_0.01_1', 'FO 3D random dist2Near simplest attachmode=1 spchg fitness mode3 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      9831}, ...
         {050, 2, 'resultados\Y2010M08D01h12m14s01\1_0.01_1', '3D random dist2Near simplest attachmode=1 spchg fitness mode3 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      9733}, ...
         {051, 2, 'resultados\Y2010M08D02h00m11s16\1_0.01_1', '3D random hoh dist2Near simplest attachmode=0 spchg fitness absabs swingAngle 0.174 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      9978}, ...
         {052, 2, 'resultados\Y2010M08D02h11m11s10\1_0.01_1', '3D random dist2Near simplest attachmode=1 spchg fitness mode3 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      7771}, ...
         {053, 2, 'resultados\Y2010M08D02h18m39s39\1_0.01_1', '3D random dist2Near simplest attachmode=1 spchg fitness mode3 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      6875}, ...
         {054, 2, 'resultados\Y2010M08D02h18m43s32\1_0.01_1', 'FO 3D random dist2Near simplest attachmode=1 spchg fitness mode3 zerosnan=false rotation pacoselec noreplacenan elitism pob=100',      7573}, ...
         }; %#ok<NBRAK>

         
       
switch mode
  case 'data'
    results = data;
    return
  case 'all'
  case 'sims'
    selection      = sels;
    data           = data(selection);
  case 'select'
    selections     = sels;
    selection      = zeros(size(selections));
    for k=1:numel(selections)
      id           = selections{k}{1};
      selecs       = selections{k}{2};
      selection(k) = id;
      data{id}{5}  = data{id}{5}(selecs);
    end
    data           = data(selection);
  otherwise
    error('mode==%s not understood!!!', any2str(mode));
end

if ~iscell(confs)
  confs = repmat({confs}, size(data));
end

dosave = ~isempty(save) && ischar(save);
     
results = cellfun(@(x)struct('path', x{3}, 'mode', x{4}, 'inds', x{5}(:)), data);
results(end).structs = [];
typ     = cellfun(@(x)x{2}, data);

pophname    = 'pophSG.mat';
% useKeyboard = false;
% outputrec   = true;

for k=1:numel(results)
  inds               = results(k).inds;
  path               = results(k).path;
  path(path=='\')    = filesep;
  path(path=='/')    = filesep;
  results(k).structs = cell(size(inds));
  clear('poph');
  fname = [path filesep pophname];
  if exist(fname, 'file')
    load(fname);
  else
    poph = confs{k}.fun.loadSim(path);
  end
  for z=1:numel(inds)
    n                     = inds(z);
    fprintf('Let''s go for ind %d in %s...\n', n, path);
    switch typ(k)
      case 1
        results(k).structs{z} = evaluarMolMot(poph.params.genome2str(poph.genome{n}), poph.params.evparams, poph.rndSeedDev{n}, poph.rndSeedEv{n}, varargin{:});%useKeyboard, outputrec);
      case 2
        results(k).structs{z} = confs{k}.fun.replayGenome(poph, 'poph', n, varargin{:}); 
    end
  end
  if dosave
    saveR(save, results(k));
  end
end

function saveR(saveStr, results)
pth = results.path;
seps = find(pth==filesep);
pth = pth(seps(end-1)+1:seps(end)-1);
save([saveStr pth], 'results');
